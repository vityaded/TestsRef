<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }} - Jeopardy</title>
  <style>
    :root {
      --board-bg: #0d1555;
      --header-bg: #07103a;
      --cell-bg: #1c2b8c;
      --cell-hover: #2436a6;
      --text-color: #f8f9fc;
      --accent: #f2c94c;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Arial', sans-serif;
      background: radial-gradient(circle at 10% 20%, rgba(49, 130, 206, 0.2), transparent 25%),
                  radial-gradient(circle at 90% 10%, rgba(246, 173, 85, 0.25), transparent 25%),
                  var(--board-bg);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 32px 12px 48px;
    }

    h1 {
      margin: 0 0 16px;
      text-align: center;
      letter-spacing: 1px;
    }

    p.lead {
      margin: 0 0 24px;
      color: rgba(248, 249, 252, 0.85);
      text-align: center;
    }

    .board-wrapper {
      width: min(1200px, 100%);
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35);
    }

    thead th {
      background: var(--header-bg);
      color: var(--accent);
      padding: 18px 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 18px;
      border: 2px solid rgba(255, 255, 255, 0.14);
      position: sticky;
      top: 0;
      z-index: 1;
    }

    tbody td {
      border: 2px solid rgba(255, 255, 255, 0.14);
      padding: 20px 12px;
      text-align: center;
      font-size: 22px;
      font-weight: 700;
      color: var(--accent);
      background: var(--cell-bg);
      cursor: pointer;
      transition: background 0.2s ease, transform 0.1s ease;
      min-width: 140px;
    }

    tbody td:hover { background: var(--cell-hover); transform: translateY(-2px); }
    tbody td.used { background: #11183f; color: rgba(242, 201, 76, 0.55); cursor: default; }
    tbody td.empty { background: rgba(255, 255, 255, 0.05); cursor: default; }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.65);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 10;
    }

    .modal.open { display: flex; }

    .modal-card {
      width: min(700px, 100%);
      background: #0a0f2a;
      color: var(--text-color);
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 30px 70px rgba(0, 0, 0, 0.45);
      position: relative;
    }

    .modal-card h2 { margin: 0 0 12px; color: var(--accent); }
    .modal-card p { margin: 0 0 14px; line-height: 1.5; }
    .modal-card .value { font-weight: 700; letter-spacing: 0.5px; }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 18px;
    }

    button {
      border: none;
      border-radius: 6px;
      padding: 10px 14px;
      font-weight: 600;
      cursor: pointer;
    }

    .btn-primary { background: var(--accent); color: #0a0f2a; }
    .btn-secondary { background: rgba(255, 255, 255, 0.12); color: var(--text-color); }
  </style>
</head>
<body>
  <h1>{{ title }}</h1>
  <p class="lead">Click a value to reveal the clue, then flip the answer when you're ready.</p>

  <div class="board-wrapper">
    <table aria-label="Jeopardy board">
      <thead>
        <tr>
          {% for category in categories %}
            <th scope="col">{{ category }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row_index in range(max_rows) %}
          <tr>
            {% for category in categories %}
              {% set column_entries = entries.get(category, []) %}
              {% set clue = column_entries[row_index] if column_entries|length > row_index else None %}
              {% if clue %}
                <td class="clue" data-question="{{ clue.question|e }}" data-answer="{{ clue.answer|e }}" data-value="{{ clue.value }}">{{ clue.value }}</td>
              {% else %}
                <td class="empty" aria-hidden="true"></td>
              {% endif %}
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="modal" id="clueModal" role="dialog" aria-modal="true" aria-labelledby="clueTitle">
    <div class="modal-card">
      <h2 id="clueTitle">Clue</h2>
      <p class="value" id="clueValue"></p>
      <p id="clueQuestion"></p>
      <p id="clueAnswer" style="display:none;"></p>
      <div class="modal-actions">
        <button class="btn-secondary" type="button" id="closeClue">Close</button>
        <button class="btn-primary" type="button" id="revealAnswer">Reveal Answer</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      var modal = document.getElementById('clueModal');
      var valueEl = document.getElementById('clueValue');
      var questionEl = document.getElementById('clueQuestion');
      var answerEl = document.getElementById('clueAnswer');
      var closeBtn = document.getElementById('closeClue');
      var revealBtn = document.getElementById('revealAnswer');

      function openClue(cell) {
        questionEl.textContent = cell.dataset.question;
        answerEl.textContent = 'Answer: ' + cell.dataset.answer;
        valueEl.textContent = 'Value: ' + cell.dataset.value;
        answerEl.style.display = 'none';
        revealBtn.style.display = '';
        modal.classList.add('open');
        cell.classList.add('used');
        cell.textContent = 'â€”';
      }

      function closeClue() {
        modal.classList.remove('open');
      }

      closeBtn.addEventListener('click', closeClue);
      revealBtn.addEventListener('click', function () {
        answerEl.style.display = '';
        revealBtn.style.display = 'none';
      });

      modal.addEventListener('click', function (event) {
        if (event.target === modal) {
          closeClue();
        }
      });

      document.querySelectorAll('.clue').forEach(function (cell) {
        cell.addEventListener('click', function () {
          if (cell.classList.contains('used')) return;
          openClue(cell);
        });
      });
    })();
  </script>
</body>
</html>
